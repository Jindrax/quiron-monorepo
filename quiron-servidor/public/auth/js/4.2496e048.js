(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"8b24":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-page",{staticClass:"flex flex-center"},[i("q-list",{attrs:{separator:""}},[i("mostrar-campo",{attrs:{etiqueta:"Identificacion"}},[i("q-input",{model:{value:t.objeto.identificacion,callback:function(e){t.$set(t.objeto,"identificacion",e)},expression:"objeto.identificacion"}})],1),i("mostrar-campo",{attrs:{etiqueta:"Contraseña"}},[i("q-input",{attrs:{type:"password"},nativeOn:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.resolverAccion.apply(null,arguments)}},model:{value:t.objeto.password,callback:function(e){t.$set(t.objeto,"password",e)},expression:"objeto.password"}})],1),t.autenticacion_anormal?["c"===t.tipo_recolector||"i"===t.tipo_recolector||"ci"===t.tipo_recolector?i("mostrar-campo",{ref:"mostrar",attrs:{etiqueta:"Confirmar Contraseña"}},[i("q-input",{attrs:{type:"password"},model:{value:t.objeto.confirmacion,callback:function(e){t.$set(t.objeto,"confirmacion",e)},expression:"objeto.confirmacion"}})],1):t._e(),"i"===t.tipo_recolector||"ci"===t.tipo_recolector?i("div",[i("div",{staticStyle:{width:"100%"}},[i("div",{staticClass:"row text-subtitle1"},[t._v("Firma")]),i("div",{staticClass:"row"},[i("panel-firma",{ref:"firma",staticStyle:{width:"100%"}})],1)])]):t._e()]:t._e(),i("q-item",[i("q-item-section",[i("q-btn",{attrs:{label:t.labelResolver},on:{click:t.resolverAccion}})],1)],1)],2)],1)},a=[],n=i("60a3"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-item",{staticClass:"q-ma-none q-px-none q-py-xs"},[i("q-item-section",[i("div",t._l(t.campos,(function(e,o){return i("div",{key:o,staticClass:"row items-center"},[i("div",{class:t.EtiquetaClase},[t._v(t._s(e))]),i("div",{class:t.ContenidoClase},[t._t(t.obtenerNombre(o))],2)])})),0)])],1)},s=[],c=i("0967"),l=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};let u=class extends n["d"]{obtenerNombre(t){return Array.isArray(this.etiqueta)?this.etiqueta[t]:"default"}get campos(){return Array.isArray(this.etiqueta)?this.etiqueta:[this.etiqueta]}get EtiquetaClase(){return c["b"].is.mobile?"col-12":this.printable?"q-mx-sm":"col"}get ContenidoClase(){return c["b"].is.mobile?"col-12":"col"}};l([Object(n["b"])()],u.prototype,"etiqueta",void 0),l([Object(n["b"])({default:!1})],u.prototype,"printable",void 0),u=l([Object(n["a"])({name:"mostrar-campo"})],u);var h=u;n["d"].component("mostrar-campo",u);var f=h,d=i("2877"),p=i("66e5"),m=i("4074"),b=i("eebe"),v=i.n(b),y=Object(d["a"])(f,r,s,!1,null,null,null),w=y.exports;v()(y,"components",{QItem:p["a"],QItemSection:m["a"]});var j=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"container",staticStyle:{height:"300px"}},[i("q-resize-observer",{on:{resize:t.redimensionar}}),i("canvas",{ref:"canvas",staticStyle:{background:"silver"},attrs:{height:t.canvasH,width:t.canvasW}}),i("div",{staticClass:"row justify-end"},[i("q-btn",{staticStyle:{width:"100%"},on:{click:t.reiniciar_firma}},[t._v("Limpiar")])],1)],1)},g=[],_=i("2b0e"),q=i("2fe1"),C=i("90e2"),O=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};let x=class extends _["a"]{constructor(){super(...arguments),this.signature=null,this.container=null,this.canvas=null,this.canvasH=100,this.canvasW=100}guardar_firma(){if(null!=this.signature)return this.signature.toDataURL();console.log("Error en la redimension del componente de firma")}reiniciar_firma(){this.signature.clear()}redimensionar(){null!=this.container&&null!=this.canvas&&(this.canvasH!=this.container.clientHeight-47&&(this.canvasH=this.container.clientHeight-47),this.canvasW!=this.container.clientWidth&&(this.canvasW=this.container.clientWidth),this.signature=new C["a"](this.canvas,{dotSize:3,minWidth:1.5,maxWidth:3.5,throttle:1,minDistance:5}),this.signature.clear())}mounted(){this.container=this.$refs.container,this.canvas=this.$refs.canvas,this.canvas.getContext("2d").scale(.1,.1),this.redimensionar()}};x=O([q["b"]],x);var k=x,R=k,$=i("3980"),A=i("9c40"),P=Object(d["a"])(R,j,g,!1,null,null,null),z=P.exports;v()(P,"components",{QResizeObserver:$["a"],QBtn:A["a"]});var E=i("bc3a"),I=i.n(E),Q=i("84f8"),S=function(t,e,i,o){function a(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,n){function r(t){try{c(o.next(t))}catch(e){n(e)}}function s(t){try{c(o["throw"](t))}catch(e){n(e)}}function c(t){t.done?i(t.value):a(t.value).then(r,s)}c((o=o.apply(t,e||[])).next())}))};class W{static posteo(t,e,i,o){return S(this,void 0,void 0,(function*(){try{const a=yield I.a.post(`${this.url}/${t}`,e,i);return o?this.procesarRespuesta(o,a.data):a.data}catch(a){this.procesarError(a)}}))}static actualizar(t,e,i,o){return S(this,void 0,void 0,(function*(){try{const a=yield I.a.patch(`${this.url}/${t}`,e,i);return o?this.procesarRespuesta(o,a.data):a.data}catch(a){this.procesarError(a)}}))}static procesarError(t){throw console.log(t.response.data),t.response.data}static procesarRespuesta(t,e){return Object(Q["a"])(t,e)}}W.url=window.location.origin;var H=i("015a"),L=i("7ae2"),D=i("18d6"),U=function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},F=function(t,e,i,o){function a(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,n){function r(t){try{c(o.next(t))}catch(e){n(e)}}function s(t){try{c(o["throw"](t))}catch(e){n(e)}}function c(t){t.done?i(t.value):a(t.value).then(r,s)}c((o=o.apply(t,e||[])).next())}))};let N=class extends n["d"]{constructor(){super(...arguments),this.objeto={identificacion:"",password:"",confirmacion:"",cambios:{firma:""}},this.autenticacion_anormal=!1,this.tipo_recolector=""}get labelResolver(){switch(this.tipo_recolector){case"":return"Iniciar sesion";case"c":return"Cambiar contraseña";case"i":return"Actualizar usuario";case"ci":return"Actualizar usuario"}}login(){return F(this,void 0,void 0,(function*(){try{let t=yield W.posteo("session",this.objeto,{withCredentials:!0});delete t.token,D["a"].set("usuario",t),this.reinicarComponente(),window.location.replace(window.location.origin)}catch(t){switch(this.$q.notify(t.message),t.code){case L["a"].CAMBIO_PASS:this.autenticacion_anormal=!0,this.tipo_recolector="c";break;case L["a"].FALTA_INFORMACION:this.autenticacion_anormal=!0,this.tipo_recolector="ci";break}}}))}cambiarPassword(){return F(this,void 0,void 0,(function*(){if(this.objeto.password==this.objeto.confirmacion)try{console.log(yield W.actualizar("session/pass",this.objeto,void 0,H["a"])),this.$q.notify("Contraseña actualizada correctamente"),this.reinicarComponente()}catch(t){console.log(t)}else this.$q.notify("Las contraseñas no coinciden")}))}resolverAccion(){switch(this.tipo_recolector){case"":this.login();break;case"c":this.cambiarPassword();break;case"i":this.nuevoUsuario();break;case"ci":this.nuevoUsuario();break}}nuevoUsuario(){return F(this,void 0,void 0,(function*(){if(this.objeto.password==this.objeto.confirmacion)try{this.objeto.cambios.firma=this.firmaRef.guardar_firma(),console.log(yield W.actualizar("session/info",this.objeto,void 0,H["a"])),this.$q.notify("Usuario actualizado correctamente puede iniciar sesion normalmente")}catch(t){this.$q.notify(t.message)}else this.$q.notify("Las contraseñas no coinciden")}))}reinicarComponente(){this.objeto.identificacion="",this.objeto.password="",this.objeto.confirmacion="",this.objeto.cambios.firma="",this.autenticacion_anormal=!1,this.tipo_recolector=""}};U([Object(n["c"])("firma")],N.prototype,"firmaRef",void 0),N=U([Object(n["a"])({components:{MostrarCampo:w,PanelFirma:z}})],N);var B=N,M=B,J=i("9989"),T=i("1c1c"),G=i("27f9"),K=Object(d["a"])(M,o,a,!1,null,null,null);e["default"]=K.exports;v()(K,"components",{QPage:J["a"],QList:T["a"],QInput:G["a"],QItem:p["a"],QItemSection:m["a"],QBtn:A["a"]})}}]);