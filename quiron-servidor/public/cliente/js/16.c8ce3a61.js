(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{f489:function(e,s,t){"use strict";t.r(s);var i=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("q-page",[t("q-card",[t("q-item",[t("q-item-section",[t("q-btn",{staticClass:"full-width",attrs:{label:"Buscar rol a editar"},on:{click:e.buscarRol}})],1)],1),t("q-card-section",[t("mostrar-campo",{attrs:{etiqueta:"Identificador"}},[t("q-input",{model:{value:e.rol.identificador,callback:function(s){e.$set(e.rol,"identificador",s)},expression:"rol.identificador"}})],1),t("mostrar-campo",{attrs:{etiqueta:"Descripcion"}},[t("q-input",{attrs:{filled:"",autogrow:""},model:{value:e.rol.descripcion,callback:function(s){e.$set(e.rol,"descripcion",s)},expression:"rol.descripcion"}})],1),t("q-markup-table",{attrs:{separator:"cell"}},[t("thead",[t("tr",[t("th",{attrs:{colspan:"2"}},[e._v("Permisos disponibles")])]),t("tr",[t("th",[e._v("Recurso")]),t("th",[e._v("Descripcion")])])]),t("tbody",e._l(e.permisosTable,(function(s,i){return t("tr",{key:"resource_"+i,staticClass:"q-chip--clickable",on:{click:function(s){return e.enablePermiso(i)}}},[t("td",[t("q-badge",[e._v(e._s(s.action))]),e._v("\n            "+e._s(s.resource)+"\n          ")],1),t("td",[e._v(e._s(s.description))])])})),0)]),t("q-markup-table",{attrs:{separator:"cell"}},[t("thead",[t("tr",[t("th",{attrs:{colspan:"2"}},[e._v("Permisos habilitados")])]),t("tr",[t("th",[e._v("Recurso")]),t("th",[e._v("Descripcion")])])]),t("tbody",e._l(e.permisosEnabled,(function(s,i){return t("tr",{key:"enabledresource_"+i,staticClass:"q-chip--clickable",on:{click:function(s){return e.disablePermiso(i)}}},[t("td",[t("q-badge",[e._v(e._s(s.action))]),e._v("\n            "+e._s(s.resource)+"\n          ")],1),t("td",[e._v(e._s(s.description))])])})),0)])],1),t("q-card-actions",[t("q-btn",{staticClass:"full-width",attrs:{label:"Crear rol"},on:{click:e.crearRol}})],1)],1)],1)},o=[],r=t("95ad"),n=t("691c"),a=t("75a0"),c=t("e2c2"),l=t("378a"),d=function(e,s,t,i){var o,r=arguments.length,n=r<3?s:null===i?i=Object.getOwnPropertyDescriptor(s,t):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)n=Reflect.decorate(e,s,t,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(r<3?o(n):r>3?o(s,t,n):o(s,t))||n);return r>3&&n&&Object.defineProperty(s,t,n),n},p=function(e,s,t,i){function o(e){return e instanceof t?e:new t((function(s){s(e)}))}return new(t||(t=Promise))((function(t,r){function n(e){try{c(i.next(e))}catch(s){r(s)}}function a(e){try{c(i["throw"](e))}catch(s){r(s)}}function c(e){e.done?t(e.value):o(e.value).then(n,a)}c((i=i.apply(e,s||[])).next())}))};let u=class extends r["e"]{constructor(){super(...arguments),this.rol=new l["Rol"]({}),this.permisos={},this.permisosBank={},this.permisosEnabled=[]}reiniciarDatos(){this.rol=new l["Rol"]({}),this.permisos=this.permisosBank,this.permisosEnabled=[]}processPermisos(){const e={};for(const s of this.permisosEnabled)e[`${s.action}@${s.resource}`]=s;return e}crearRol(){return p(this,void 0,void 0,(function*(){try{yield a["a"].post("rol",{identificador:this.rol.identificador,descripcion:this.rol.descripcion,permisos:this.processPermisos()}),this.reiniciarDatos(),this.$q.notify({message:"Rol creado correctamente"})}catch(e){console.log(e),this.$q.notify({message:e.message})}}))}mounted(){return p(this,void 0,void 0,(function*(){this.permisos=yield a["a"].get("permisos"),console.log(this.permisos),this.permisosBank=JSON.parse(JSON.stringify(this.permisos))}))}get permisosTable(){const e=[];for(const s of Object.values(this.permisos))e.push(s);return e}enablePermiso(e){const s=this.permisosTable[e];this.$set(this.permisosEnabled,this.permisosEnabled.length,this.permisosTable[e]),this.$delete(this.permisos,`${s.action}@${s.resource}`)}disablePermiso(e){const s=this.permisosEnabled[e];this.$delete(this.permisosEnabled,this.permisosEnabled.indexOf(s)),this.$set(this.permisos,`${s.action}@${s.resource}`,s)}syncPermissionsToRol(e){for(const s of Object.values(e.permisos))this.$set(this.permisosEnabled,this.permisosEnabled.length,s),this.$delete(this.permisos,`${s.action}@${s.resource}`)}buscarRol(){let e={campos_busqueda:[{etiqueta:"Identificador",valor:"identificador"}],campos_presentacion:[{etiqueta:"Identificador",valor:"identificador"},{etiqueta:"Descripcion",valor:"descripcion"}],opciones_busqueda:{}};this.$q.dialog({component:c["a"],parent:this,endpoint:"roles",clase:l["Rol"],opciones:e,persistent:!0}).onOk((e=>{this.rol=e,this.syncPermissionsToRol(e)})).onCancel((e=>{console.log(e)}))}};u=d([Object(r["a"])({components:{MostrarCampo:n["a"]}})],u);var h=u,m=h,f=t("a6c2"),b=t("505d"),v=t("5ce7"),_=t("e0e9"),q=t("6c44"),g=t("ef9c"),$=t("7006"),k=t("a3be"),y=t("c101"),w=t("837a"),R=t("ec38"),P=t("84df"),E=t("63c1"),C=t.n(E),O=Object(f["a"])(m,i,o,!1,null,null,null);s["default"]=O.exports;C()(O,"components",{QPage:b["a"],QCard:v["a"],QItem:_["a"],QItemSection:q["a"],QBtn:g["a"],QCardSection:$["a"],QInput:k["a"],QMarkupTable:y["a"],QChip:w["a"],QBadge:R["a"],QCardActions:P["a"]})}}]);