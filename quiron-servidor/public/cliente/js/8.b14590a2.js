(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"713b":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-layout",{attrs:{view:"lHh Lpr lFf"}},[t.auth?[a("q-header",{attrs:{elevated:""}},[a("q-toolbar",[a("q-btn",{attrs:{"aria-label":"Menu",dense:"",flat:"",icon:"menu",round:""},on:{click:function(e){t.leftDrawerOpen=!t.leftDrawerOpen}}}),a("q-toolbar-title",[t._v("\n          "+t._s(t.usuario.nombres)+" "+t._s(t.usuario.apellidos)+"\n        ")]),a("q-btn",{attrs:{color:"secondary",label:"Cerrar sesion"},on:{click:t.signOut}})],1)],1),a("q-drawer",{attrs:{bordered:"","content-class":"bg-grey-1","show-if-above":""},model:{value:t.leftDrawerOpen,callback:function(e){t.leftDrawerOpen=e},expression:"leftDrawerOpen"}},[a("q-list",[a("q-item-label",{staticClass:"text-grey-8",attrs:{header:""}},[t._v("\n          Comandos\n        ")]),t._l(t.hubsCatalogo,(function(e){return a("q-item",{key:"hub_key_"+e.id,attrs:{to:e.route,replace:""}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:e.icon}})],1),a("q-item-section",[t._v("\n            "+t._s(e.label)+"\n          ")])],1)}))],2)],1),a("q-page-container",[a("router-view")],1)]:[a("q-page-container",[a("AuthHelper")],1)]],2)},i=[],r=a("95ad"),n=a("edd6"),s=a("4baa"),c=a("caca"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"flex flex-center"},[a("q-list",{attrs:{separator:""}},[a("mostrar-campo",{attrs:{etiqueta:"Identificacion"}},[a("q-input",{model:{value:t.objeto.identificacion,callback:function(e){t.$set(t.objeto,"identificacion",e)},expression:"objeto.identificacion"}})],1),a("mostrar-campo",{attrs:{etiqueta:"Contraseña"}},[a("q-input",{attrs:{type:"password"},nativeOn:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.resolverAccion.apply(null,arguments)}},model:{value:t.objeto.password,callback:function(e){t.$set(t.objeto,"password",e)},expression:"objeto.password"}})],1),t.autenticacion_anormal?["c"===t.tipo_recolector||"i"===t.tipo_recolector||"ci"===t.tipo_recolector?a("mostrar-campo",{ref:"mostrar",attrs:{etiqueta:"Confirmar Contraseña"}},[a("q-input",{attrs:{type:"password"},model:{value:t.objeto.confirmacion,callback:function(e){t.$set(t.objeto,"confirmacion",e)},expression:"objeto.confirmacion"}})],1):t._e(),"i"===t.tipo_recolector||"ci"===t.tipo_recolector?a("div",[a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"row text-subtitle1"},[t._v("Firma")]),a("div",{staticClass:"row"},[a("panel-firma",{ref:"firma",staticStyle:{width:"100%"}})],1)])]):t._e()]:t._e(),a("q-item",[a("q-item-section",[a("q-btn",{attrs:{label:t.labelResolver},on:{click:t.resolverAccion}})],1)],1)],2)],1)},u=[],h=a("378a"),f=a("ff24"),d=a("7338"),p=a.n(d),m=a("34ca"),b=function(t,e,a,o){function i(t){return t instanceof a?t:new a((function(e){e(t)}))}return new(a||(a=Promise))((function(a,r){function n(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o["throw"](t))}catch(e){r(e)}}function c(t){t.done?a(t.value):i(t.value).then(n,s)}c((o=o.apply(t,e||[])).next())}))};class v{static posteo(t,e,a,o){return b(this,void 0,void 0,(function*(){try{const i=yield p.a.post(`${this.url}/${t}`,e,a);return o?this.procesarRespuesta(o,i.data):i.data}catch(i){this.procesarError(i)}}))}static actualizar(t,e,a,o){return b(this,void 0,void 0,(function*(){try{const i=yield p.a.patch(`${this.url}/${t}`,e,a);return o?this.procesarRespuesta(o,i.data):i.data}catch(i){this.procesarError(i)}}))}static procesarError(t){throw console.log(t.response.data),t.response.data}static procesarRespuesta(t,e){return Object(m["plainToClass"])(t,e)}}v.url=window.location.origin;var y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-item",{staticClass:"q-ma-none q-px-none q-py-xs"},[a("q-item-section",[a("div",t._l(t.campos,(function(e,o){return a("div",{key:o,staticClass:"row items-center"},[a("div",{class:t.EtiquetaClase},[t._v(t._s(e))]),a("div",{class:t.ContenidoClase},[t._t(t.obtenerNombre(o))],2)])})),0)])],1)},g=[],w=a("8d5f"),_=function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};let q=class extends r["e"]{obtenerNombre(t){return Array.isArray(this.etiqueta)?this.etiqueta[t]:"default"}get campos(){return Array.isArray(this.etiqueta)?this.etiqueta:[this.etiqueta]}get EtiquetaClase(){return w["b"].is.mobile?"col-12":this.printable?"q-mx-sm":"col"}get ContenidoClase(){return w["b"].is.mobile?"col-12":"col"}};_([Object(r["b"])()],q.prototype,"etiqueta",void 0),_([Object(r["b"])({default:!1})],q.prototype,"printable",void 0),q=_([Object(r["a"])({name:"mostrar-campo"})],q);var j=q;r["e"].component("mostrar-campo",q);var O=j,C=a("a6c2"),k=a("e0e9"),x=a("6c44"),R=a("63c1"),Q=a.n(R),$=Object(C["a"])(O,y,g,!1,null,null,null),A=$.exports;Q()($,"components",{QItem:k["a"],QItemSection:x["a"]});var P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",staticStyle:{height:"300px"}},[a("q-resize-observer",{on:{resize:t.redimensionar}}),a("canvas",{ref:"canvas",staticStyle:{background:"silver"},attrs:{height:t.canvasH,width:t.canvasW}}),a("div",{staticClass:"row justify-end"},[a("q-btn",{staticStyle:{width:"100%"},on:{click:t.reiniciar_firma}},[t._v("Limpiar")])],1)],1)},E=[],I=a("e832"),D=a("d74d"),z=a("7f36"),H=function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};let L=class extends I["a"]{constructor(){super(...arguments),this.signature=null,this.container=null,this.canvas=null,this.canvasH=100,this.canvasW=100}guardar_firma(){if(null!=this.signature)return this.signature.toDataURL();console.log("Error en la redimension del componente de firma")}reiniciar_firma(){this.signature.clear()}redimensionar(){null!=this.container&&null!=this.canvas&&(this.canvasH!=this.container.clientHeight-47&&(this.canvasH=this.container.clientHeight-47),this.canvasW!=this.container.clientWidth&&(this.canvasW=this.container.clientWidth),this.signature=new z["a"](this.canvas,{dotSize:3,minWidth:1.5,maxWidth:3.5,throttle:1,minDistance:5}),this.signature.clear())}mounted(){this.container=this.$refs.container,this.canvas=this.$refs.canvas,this.canvas.getContext("2d").scale(.1,.1),this.redimensionar()}};L=H([D["b"]],L);var S=L,W=S,U=a("1169"),F=a("ef9c"),T=Object(C["a"])(W,P,E,!1,null,null,null),B=T.exports;Q()(T,"components",{QResizeObserver:U["a"],QBtn:F["a"]});var M=function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n},N=function(t,e,a,o){function i(t){return t instanceof a?t:new a((function(e){e(t)}))}return new(a||(a=Promise))((function(a,r){function n(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o["throw"](t))}catch(e){r(e)}}function c(t){t.done?a(t.value):i(t.value).then(n,s)}c((o=o.apply(t,e||[])).next())}))};let J=class extends r["e"]{constructor(){super(...arguments),this.objeto={identificacion:"",password:"",confirmacion:"",cambios:{firma:""}},this.autenticacion_anormal=!1,this.tipo_recolector=""}get labelResolver(){switch(this.tipo_recolector){case"":return"Iniciar sesion";case"c":return"Cambiar contraseña";case"i":return"Actualizar usuario";case"ci":return"Actualizar usuario"}}login(){return N(this,void 0,void 0,(function*(){try{let t=yield v.posteo("session",this.objeto,{withCredentials:!0});delete t.token,c["a"].set("usuario",t),this.reinicarComponente(),location.reload()}catch(t){switch(this.$q.notify(t.message),t.code){case f["ErrorEnum"].CAMBIO_PASS:this.autenticacion_anormal=!0,this.tipo_recolector="c";break;case f["ErrorEnum"].FALTA_INFORMACION:this.autenticacion_anormal=!0,this.tipo_recolector="ci";break}}}))}cambiarPassword(){return N(this,void 0,void 0,(function*(){if(this.objeto.password==this.objeto.confirmacion)try{console.log(yield v.actualizar("session/pass",this.objeto,void 0,h["Usuario"])),this.$q.notify("Contraseña actualizada correctamente"),this.reinicarComponente()}catch(t){console.log(t)}else this.$q.notify("Las contraseñas no coinciden")}))}resolverAccion(){switch(this.tipo_recolector){case"":this.login();break;case"c":this.cambiarPassword();break;case"i":this.nuevoUsuario();break;case"ci":this.nuevoUsuario();break}}nuevoUsuario(){return N(this,void 0,void 0,(function*(){if(this.objeto.password==this.objeto.confirmacion)try{this.objeto.cambios.firma=this.firmaRef.guardar_firma(),console.log(yield v.actualizar("session/info",this.objeto,void 0,h["Usuario"])),this.$q.notify("Usuario actualizado correctamente puede iniciar sesion normalmente")}catch(t){this.$q.notify(t.message)}else this.$q.notify("Las contraseñas no coinciden")}))}reinicarComponente(){this.objeto.identificacion="",this.objeto.password="",this.objeto.confirmacion="",this.objeto.cambios.firma="",this.autenticacion_anormal=!1,this.tipo_recolector=""}};M([Object(r["d"])("firma")],J.prototype,"firmaRef",void 0),J=M([Object(r["a"])({components:{MostrarCampo:A,PanelFirma:B}})],J);var G=J,K=G,V=a("505d"),X=a("692f"),Y=a("a3be"),Z=Object(C["a"])(K,l,u,!1,null,"5962b4d6",null),tt=Z.exports;Q()(Z,"components",{QPage:V["a"],QList:X["a"],QInput:Y["a"],QItem:k["a"],QItemSection:x["a"],QBtn:F["a"]});var et=function(t,e,a,o){var i,r=arguments.length,n=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,a):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)n=Reflect.decorate(t,e,a,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(n=(r<3?i(n):r>3?i(e,a,n):i(e,a))||n);return r>3&&n&&Object.defineProperty(e,a,n),n};let at=class extends r["e"]{constructor(){super(...arguments),this.leftDrawerOpen=!1,this.usuario=c["a"].getItem("usuario"),this.auth=!1}get hubsCatalogo(){return n["a"].getHubsForLayout()}signOut(){s["a"].remove("token"),c["a"].remove("usuario"),this.auth=!1,location.reload()}mounted(){this.auth=this.authResolver()}authResolver(){return c["a"].has("usuario")}};at=et([Object(r["a"])({name:"main-layout",components:{AuthHelper:tt}})],at);var ot=at,it=ot,rt=a("f624"),nt=a("8738"),st=a("66cf"),ct=a("309f"),lt=a("5cc9"),ut=a("dc7c"),ht=a("19dc"),ft=a("ddc7"),dt=Object(C["a"])(it,o,i,!1,null,null,null);e["default"]=dt.exports;Q()(dt,"components",{QLayout:rt["a"],QHeader:nt["a"],QToolbar:st["a"],QBtn:F["a"],QToolbarTitle:ct["a"],QDrawer:lt["a"],QList:X["a"],QItemLabel:ut["a"],QItem:k["a"],QItemSection:x["a"],QIcon:ht["a"],QPageContainer:ft["a"]})}}]);